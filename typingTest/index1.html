<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Typing Speed Test</title>
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
        background: linear-gradient(135deg, #a18cd1, #fbc2eb);
        color: #333;
        padding: 20px;
    }
    .container {
        max-width: 600px;
        margin: auto;
        background: rgba(255, 255, 255, 0.9);
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 0 15px rgba(0,0,0,0.2);
    }
    #quote {
        font-size: 18px;
        margin-bottom: 20px;
    }
    textarea {
        width: 100%;
        height: 100px;
        font-size: 16px;
        padding: 10px;
        margin-bottom: 15px;
        border: 3px solid #ccc;
        border-radius: 6px;
        outline: none;
        transition: border-color 0.2s;
    }
    .correct-border {
        border-color: green !important;
    }
    .wrong-border {
        border-color: red !important;
    }
    button, select {
        padding: 10px 15px;
        margin: 5px;
        font-size: 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
    }
    button {
        background-color: #6a5acd;
        color: white;
    }
    button:hover {
        background-color: #5a4bbf;
    }
    select {
        background-color: #eee;
    }
</style>
</head>
<body>

<div class="container">
    <h1>Typing Speed Test</h1>
    <select id="timeSelect">
        <option value="60">1 Minute</option>
        <option value="30">30 Seconds</option>
        <option value="10">10 Seconds</option>
    </select>
    <p><strong>Time Left:</strong> <span id="timer">60</span>s</p>
    <p id="quote">Loading quote...</p>
    <textarea id="quoteInput" placeholder="Start typing here..." disabled></textarea><br>
    <button id="startBtn">Start Test</button>
    <button id="submitBtn" disabled>Submit</button>
    <p id="result"></p>
</div>

<script>
let quoteDisplay = document.getElementById("quote");
let quoteInput = document.getElementById("quoteInput");
let timerDisplay = document.getElementById("timer");
let startBtn = document.getElementById("startBtn");
let submitBtn = document.getElementById("submitBtn");
let resultEl = document.getElementById("result");
let timeSelect = document.getElementById("timeSelect");

let timeLimit = 60;
let timeLeft = 60;
let timerId = null;
let quote = "";
let apiQuotes = [];

// Fetch quotes from API
async function loadQuotes() {
    try {
        let res = await fetch("https://dummyjson.com/quotes");
        let data = await res.json();
        apiQuotes = data.quotes;
    } catch (error) {
        quoteDisplay.textContent = "Failed to load quotes!";
    }
}

// Pick a random quote
function showNewQuote() {
    if (apiQuotes.length > 0) {
        let randomIndex = Math.floor(Math.random() * apiQuotes.length);
        quote = apiQuotes[randomIndex].quote;
        quoteDisplay.textContent = quote;
    }
}

// Live typing border feedback
quoteInput.addEventListener("input", () => {
    let typed = quoteInput.value;
    if (quote.startsWith(typed)) {
        quoteInput.classList.add("correct-border");
        quoteInput.classList.remove("wrong-border");
    } else {
        quoteInput.classList.add("wrong-border");
        quoteInput.classList.remove("correct-border");
    }
});

// Start the test
startBtn.onclick = function () {
    timeLimit = parseInt(timeSelect.value);
    timeLeft = timeLimit;
    timerDisplay.textContent = timeLeft;
    quoteInput.value = "";
    resultEl.textContent = "";
    quoteInput.disabled = false;
    submitBtn.disabled = false;
    quoteInput.focus();
    showNewQuote();
    clearInterval(timerId);
    timerId = setInterval(updateTimer, 1000);
};

// Timer countdown
function updateTimer() {
    timeLeft--;
    timerDisplay.textContent = timeLeft;
    if (timeLeft <= 0) {
        clearInterval(timerId);
        checkResult();
    }
}

// Submit button
submitBtn.onclick = function () {
    clearInterval(timerId);
    checkResult();
};

// Check result
function checkResult() {
    quoteInput.disabled = true;
    submitBtn.disabled = true;
    let typedValue = quoteInput.value.trim();
    let timeTaken = timeLimit - timeLeft;

    if (typedValue === quote) {
        let wpm = Math.round((typedValue.split(" ").length / timeTaken) * 60);
        resultEl.textContent = `🎉 You completed in ${timeTaken} seconds! WPM: ${wpm}`;
    } else if (timeLeft <= 0) {
        resultEl.textContent = "⏳ Time's up! Try again.";
    } else {
        resultEl.textContent = "❌ Quote not typed exactly.";
    }
}

// Load quotes on page load
loadQuotes();
</script>

</body>
</html>
